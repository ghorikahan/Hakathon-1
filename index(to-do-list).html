<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnSmart AI | EdTech 2.0 Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #f59e0b;
            --danger: #ef4444;
            --light: #f8f9fa;
            --dark: #1e293b;
            --gray: #64748b;
            --light-gray: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header & Navigation */
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .logo i {
            color: var(--accent);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
        }

        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }

        nav a:hover,
        nav a.active {
            color: var(--primary);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* Dashboard Layout */
        .dashboard {
            display: grid;
            grid-template-columns: 280px 1fr 350px;
            gap: 25px;
            padding: 25px 0;
            min-height: calc(100vh - 80px);
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            height: fit-content;
        }

        .sidebar h3 {
            margin-bottom: 20px;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-menu {
            list-style: none;
            margin-bottom: 30px;
        }

        .sidebar-menu li {
            margin-bottom: 10px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            border-radius: 8px;
            text-decoration: none;
            color: var(--dark);
            transition: all 0.3s;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .welcome-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 12px;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .welcome-text h2 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        /* Centered Focus Timer Styles */
        .focus-timer-center {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
            margin-bottom: 25px;
        }

        .timer-header {
            margin-bottom: 25px;
        }

        .timer-header h3 {
            color: var(--secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .timer-header p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .timer-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .timer-adjustment {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .adjust-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--light);
            border: 2px solid var(--primary);
            color: var(--primary);
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .adjust-btn:hover {
            background: var(--primary);
            color: white;
        }

        .timer-display-center {
            font-size: 4rem;
            font-weight: bold;
            color: var(--primary);
            min-width: 200px;
            text-align: center;
            font-family: monospace;
        }

        .timer-controls-center {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .timer-modes {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .timer-mode-btn {
            padding: 10px 15px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            background: white;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .timer-mode-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .timer-mode-btn:hover {
            border-color: var(--primary);
        }

        /* Initially hide pause button */
        #pauseTimerBtnCenter {
            display: none;
        }

        /* Learning Path Section */
        .learning-path-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-header h3 {
            color: var(--secondary);
        }

        .path-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding-bottom: 15px;
            margin-top: 2vw;
        }

        .path-card {
            min-width: 250px;
            background: var(--light);
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid var(--primary);
            margin-bottom: 1.5vw;
        }

        .path-card h4 {
            margin-bottom: 10px;
            color: var(--dark);
        }

        .path-progress {
            margin-top: 15px;
        }

        .progress-bar {
            height: 8px;
            background-color: var(--light-gray);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress {
            height: 100%;
            background-color: var(--primary);
            border-radius: 4px;
        }

        /* Right Sidebar */
        .right-sidebar {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .ai-recommendations {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .ai-recommendation {
            background: rgba(67, 97, 238, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid var(--accent);
        }

        /* Interactive elements */
        .interactive-quiz {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .quiz-question {
            margin-bottom: 20px;
            font-weight: 500;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quiz-option:hover {
            background-color: rgba(67, 97, 238, 0.05);
            border-color: var(--primary);
        }

        .quiz-option.selected {
            background-color: rgba(67, 97, 238, 0.1);
            border-color: var(--primary);
        }

        .quiz-feedback {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .correct {
            background-color: rgba(74, 222, 128, 0.1);
            border-left: 4px solid var(--success);
        }

        .incorrect {
            background-color: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--danger);
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 30px;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--primary);
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }

            nav ul {
                display: none;
            }

            .mobile-nav.active {
                display: flex;
                flex-direction: column;
                position: absolute;
                top: 70px;
                left: 0;
                right: 0;
                background: white;
                padding: 20px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            }
        }

        /* Test Feature Styles - UPDATED */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #666;
            cursor: pointer;
        }

        .modal-body {
            padding: 20px;
        }

        .config-section {
            margin-bottom: 25px;
        }

        .config-section h4 {
            margin-bottom: 15px;
            color: var(--dark);
        }

        .config-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .config-option {
            flex: 1;
            min-width: 100px;
            text-align: center;
            padding: 15px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .config-option.active {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .time-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .time-option {
            flex: 1;
            min-width: 80px;
            text-align: center;
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
        }

        .time-option.active {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .subject-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .subject-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
        }

        .subject-checkbox input {
            margin: 0;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Test Container */
        #testContainer {
            display: none;
        }

        .test-interface {
            background: white;
            border-radius: 12px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .test-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
        }

        .test-header h2 {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .test-timer {
            font-weight: bold;
            font-size: 1.2rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
        }

        .test-body {
            padding: 30px;
        }

        .question-section {
            background: #f8fafc;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .question-number {
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
            font-weight: 500;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option:hover {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.05);
        }

        .option.selected {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }

        .option.incorrect {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .option-letter {
            width: 30px;
            height: 30px;
            background: #e2e8f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--dark);
        }

        .option.selected .option-letter {
            background: var(--primary);
            color: white;
        }

        .test-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .test-actions {
            display: flex;
            gap: 10px;
        }

        .question-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-btn {
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            margin-left: 2vw;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* AI Assistant Modal */
        #aiAssistantModal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .ai-modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .ai-modal-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border-radius: 15px 15px 0 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ai-avatar {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .ai-modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            margin-left: auto;
        }

        .ai-modal-body {
            padding: 30px;
        }

        .answer-review {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .correct-answer {
            color: var(--success);
            font-weight: bold;
        }

        .wrong-answer {
            color: var(--danger);
            font-weight: bold;
        }

        .ai-explanation {
            background: rgba(76, 201, 240, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .ai-tips {
            background: rgba(67, 97, 238, 0.05);
            padding: 20px;
            border-radius: 10px;
        }

        .ai-tips ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .ai-modal-footer {
            padding: 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        .question-dots {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 20px;
        }

        .question-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid #ddd;
            background: white;
        }

        .question-dot.answered {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .question-dot.current {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .question-dot.unanswered {
            background: white;
            color: #666;
        }

        /* Results Modal */
        #resultsModal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .results-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .results-header {
            padding: 30px;
            text-align: center;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 15px 15px 0 0;
        }

        .results-body {
            padding: 30px;
        }

        .score-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(var(--primary) 0% 75%, #e2e8f0 75% 100%);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 120px;
            height: 120px;
            background: white;
            border-radius: 50%;
        }

        .score-circle span {
            position: relative;
            z-index: 1;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .result-stat {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .results-footer {
            padding: 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #22c55e;
        }

        /* Tabs for content switching */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light-gray);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
        }

        .tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-outline:hover {
            background-color: rgba(67, 97, 238, 0.1);
        }

        /* extra  */
        /* Pause button styles */
        .btn-warning {
            background-color: var(--warning);
            color: white;
            border: none;
        }

        .btn-warning:hover {
            background-color: #e69500;
            color: white;
        }

        /* Timer controls layout improvements */
        .timer-controls-center {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            align-items: center;
        }

        .timer-controls-center .btn {
            min-width: 100px;
            padding: 12px 20px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .timer-controls-center .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }

        .timer-controls-center .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Button specific styles */
        #pauseTimerBtnCenter {
            display: none;
            background: linear-gradient(135deg, #f59e0b, #f97316);
        }

        #startTimerBtnCenter {
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #resetTimerBtnCenter {
            background: white;
            border: 2px solid var(--primary);
        }

        /* Animation for timer display */
        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }

            100% {
                opacity: 1;
            }
        }

        @keyframes celebrate {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .adjust-btn:active {
            transform: scale(0.9) !important;
        }

        .timer-mode-btn:active {
            transform: scale(0.95) !important;
        }

        /* ===== TODO LIST STYLES ===== */
        .todo-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        .todo-progress {
            width: 60%;
        }

        .todo-progress .progress-bar {
            height: 6px;
            margin-bottom: 0;
        }

        .todo-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        #todoInput {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: border-color 0.3s;
        }

        #todoInput:focus {
            outline: none;
            border-color: var(--primary);
        }

        #addTodoBtn {
            padding: 12px 20px;
            border-radius: 8px;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 45px;
        }

        #addTodoBtn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .todo-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 15px;
        }

        .filter-btn {
            padding: 8px 15px;
            background: white;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            color: var(--gray);
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .filter-btn:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }

        .todo-items-container {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .todo-items-container::-webkit-scrollbar {
            width: 6px;
        }

        .todo-items-container::-webkit-scrollbar-track {
            background: var(--light-gray);
            border-radius: 3px;
        }

        .todo-items-container::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .todo-item {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .todo-item.completed {
            background: rgba(74, 222, 128, 0.1);
            border-left-color: var(--success);
            opacity: 0.8;
        }

        .todo-item.high-priority {
            border-left-color: var(--danger);
            background: rgba(239, 68, 68, 0.05);
        }

        .todo-checkbox {
            margin-right: 12px;
            margin-top: 3px;
        }

        .todo-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .todo-content {
            flex: 1;
        }

        .todo-text {
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 5px;
            transition: all 0.3s;
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: var(--gray);
        }

        .todo-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--gray);
        }

        .todo-priority {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .priority-high {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .priority-medium {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .priority-low {
            background: rgba(76, 201, 240, 0.1);
            color: var(--accent);
        }

        .todo-time {
            font-size: 0.75rem;
            color: var(--gray);
        }

        .todo-actions {
            display: flex;
            gap: 8px;
            margin-left: 10px;
        }

        .todo-action-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .todo-action-btn:hover {
            background: rgba(0, 0, 0, 0.05);
            color: var(--dark);
        }

        .edit-btn:hover {
            color: var(--primary);
        }

        .delete-btn:hover {
            color: var(--danger);
        }

        .no-tasks-message {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
        }

        .no-tasks-message i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--light-gray);
        }

        .no-tasks-message p {
            font-size: 0.9rem;
        }

        .todo-hints {
            margin-top: 20px;
            padding: 15px;
            background: rgba(67, 97, 238, 0.05);
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--gray);
            border-left: 3px solid var(--accent);
        }

        .todo-hints i {
            color: var(--warning);
            margin-right: 8px;
        }

        /* Animation for completed tasks */
        @keyframes completeAnimation {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
            100% {
                transform: scale(1);
            }
        }

        .todo-item.completed-animation {
            animation: completeAnimation 0.5s ease;
        }

        /* Notification styles */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Add this after the existing media queries */
        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .right-sidebar {
                grid-row: 3;
                grid-column: 1;
                margin-top: 25px;
            }
        }

        @media (max-width: 768px) {
            .todo-stats {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .todo-progress {
                width: 100%;
            }
        }

        /* ===== TODO LIST PAGE STYLES ===== */
        /* Todo List Page */
        .todo-page {
            display: none;
            padding: 25px 0;
            min-height: calc(100vh - 80px);
        }

        .todo-page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .todo-page-header h2 {
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 2rem;
        }

        .todo-page-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .todo-page-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .todo-stat-card {
            background: var(--light);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border-top: 4px solid var(--primary);
        }

        .todo-stat-card.completed {
            border-top-color: var(--success);
        }

        .todo-stat-card.pending {
            border-top-color: var(--warning);
        }

        .todo-stat-card.high-priority {
            border-top-color: var(--danger);
        }

        .todo-stat-card .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            display: block;
            margin-bottom: 5px;
        }

        .todo-stat-card.completed .stat-number {
            color: var(--success);
        }

        .todo-stat-card.pending .stat-number {
            color: var(--warning);
        }

        .todo-stat-card.high-priority .stat-number {
            color: var(--danger);
        }

        .todo-advanced-input {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 25px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 10px;
        }

        .input-group {
            flex: 1;
            min-width: 200px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .todo-page-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: border-color 0.3s;
        }

        .todo-page-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        select.todo-page-input {
            cursor: pointer;
        }

        .todo-page-items-container {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .todo-page-item {
            display: grid;
            grid-template-columns: 50px 1fr 150px 150px 100px;
            align-items: center;
            padding: 20px;
            background: var(--light);
            border-radius: 10px;
            margin-bottom: 15px;
            transition: all 0.3s;
            border-left: 4px solid var(--primary);
        }

        .todo-page-item.completed {
            background: rgba(74, 222, 128, 0.1);
            border-left-color: var(--success);
        }

        .todo-page-item.high-priority {
            border-left-color: var(--danger);
            background: rgba(239, 68, 68, 0.05);
        }

        .todo-page-item.medium-priority {
            border-left-color: var(--warning);
            background: rgba(245, 158, 11, 0.05);
        }

        .todo-page-item.low-priority {
            border-left-color: var(--accent);
            background: rgba(76, 201, 240, 0.05);
        }

        .todo-page-checkbox {
            display: flex;
            justify-content: center;
        }

        .todo-page-text {
            font-size: 1rem;
            font-weight: 500;
            padding: 0 15px;
        }

        .todo-page-item.completed .todo-page-text {
            text-decoration: line-through;
            color: var(--gray);
        }

        .todo-page-category {
            text-align: center;
            padding: 6px 12px;
            background: rgba(67, 97, 238, 0.1);
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--primary);
        }

        .todo-page-due-date {
            text-align: center;
            font-size: 0.85rem;
            color: var(--gray);
        }

        .todo-page-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .todo-page-action-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .todo-page-action-btn:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .todo-page-edit-btn:hover {
            color: var(--primary);
        }

        .todo-page-delete-btn:hover {
            color: var(--danger);
        }

        .todo-page-no-tasks {
            text-align: center;
            padding: 60px 20px;
        }

        .todo-page-no-tasks i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--light-gray);
        }

        .todo-page-no-tasks h3 {
            margin-bottom: 10px;
            color: var(--gray);
        }

        .todo-page-filters-advanced {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .todo-page-legend {
            display: flex;
            gap: 20px;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--gray);
        }

        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }

        .legend-high {
            background: var(--danger);
        }

        .legend-medium {
            background: var(--warning);
        }

        .legend-low {
            background: var(--accent);
        }

        .legend-completed {
            background: var(--success);
        }

        @media (max-width: 1024px) {
            .todo-page-item {
                grid-template-columns: 50px 1fr 100px;
                gap: 15px;
            }
            
            .todo-page-category, .todo-page-due-date {
                display: none;
            }
            
            .todo-page-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .todo-page-item {
                grid-template-columns: 40px 1fr;
            }
            
            .todo-page-actions {
                grid-column: 1 / -1;
                justify-content: center;
                margin-top: 15px;
            }
            
            .todo-advanced-input {
                flex-direction: column;
            }
            
            .todo-page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="nav-container">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <span>LearnSmart AI</span>
                </div>

                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>

                <nav id="mainNav">
                    <ul>
                        <li><a href="#" class="active" id="dashboardLink">Dashboard</a></li>
                        <li><a href="#" data-tab="learning">Learning Path</a></li>
                        <li><a href="#" data-tab="productivity">Productivity</a></li>
                        <li><a href="#" data-tab="assessments">Assessments</a></li>
                        <li><a href="#" data-tab="resources">Resources</a></li>
                        <li><a href="#" id="dailyTasksLink"><i class="fas fa-tasks"></i> Daily Tasks</a></li>
                    </ul>
                </nav>

                <div class="user-profile">
                    <div class="avatar">JS</div>
                    <div>
                        <div class="user-name">Jamie Smith</div>
                        <div class="user-level">Advanced Learner</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Dashboard -->
    <div class="container">
        <div class="dashboard" id="mainDashboard">
            <!-- Left Sidebar -->
            <aside class="sidebar">
                <h3><i class="fas fa-compass"></i> Learning Navigation</h3>
                <ul class="sidebar-menu">
                    <li><a href="#" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
                    <li><a href="#"><i class="fas fa-graduation-cap"></i> My Courses</a></li>
                    <li><a href="#"><i class="fas fa-tasks"></i> Assignments</a></li>
                    <li><a href="#" id="testNavBtn"><i class="fas fa-file-alt"></i> Skill Assessment Test</a></li>
                    <li><a href="#"><i class="fas fa-chart-line"></i> Progress Analytics</a></li>
                    <li><a href="#"><i class="fas fa-users"></i> Study Groups</a></li>
                    <li><a href="#"><i class="fas fa-certificate"></i> Certifications</a></li>
                    <!-- ADDED DAILY TASKS LINK -->
                    
                </ul>

                <h3><i class="fas fa-bullseye"></i> Weekly Goals</h3>
                <div class="goals">
                    <div class="path-card">
                        <h4>Complete 5 lessons</h4>
                        <div class="path-progress">
                            <div class="progress-bar">
                                <div class="progress" style="width: 60%"></div>
                            </div>
                            <span>3/5 completed</span>
                        </div>
                    </div>
                    <div class="path-card">
                        <h4>Spend 10 hours learning</h4>
                        <div class="path-progress">
                            <div class="progress-bar">
                                <div class="progress" style="width: 70%"></div>
                            </div>
                            <span>7/10 hours</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Welcome Card -->
                <div class="welcome-card">
                    <div class="welcome-text">
                        <h2>Welcome back, Jamie!</h2>
                        <p>Your personalized learning plan has been updated based on your recent progress.</p>
                    </div>
                    <div class="welcome-actions">
                        <button class="btn btn-primary" id="startLearningBtn">
                            <i class="fas fa-play"></i> Continue Learning
                        </button>
                    </div>
                </div>

                <!-- Centered Focus Timer -->
                <div class="focus-timer-center">
                    <div class="timer-header">
                        <h3><i class="fas fa-clock"></i> Focus Timer</h3>
                        <p>Pomodoro technique: Focus for 30 minutes, then take a break</p>
                    </div>

                    <div class="timer-container">
                        <!-- Timer adjustment controls -->
                        <div class="timer-adjustment">
                            <button class="adjust-btn" id="decreaseTime">
                                <i class="fas fa-minus"></i>
                            </button>

                            <div class="timer-display-center" id="timerDisplayCenter">30:00</div>

                            <button class="adjust-btn" id="increaseTime">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>


                        <!-- Timer controls -->
                        <div class="timer-controls-center">
                            <button class="btn btn-warning" id="pauseTimerBtnCenter">
                                <i class="fas fa-pause"></i> Pause
                            </button>
                            <button class="btn btn-primary" id="startTimerBtnCenter">
                                <i class="fas fa-play"></i> Start
                            </button>
                            <button class="btn btn-outline" id="resetTimerBtnCenter">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>

                        <!-- Timer modes -->
                        <div class="timer-modes">
                            <button class="timer-mode-btn active" data-minutes="30">Focus (30 min)</button>
                            <button class="timer-mode-btn" data-minutes="5">Short Break (5 min)</button>
                            <button class="timer-mode-btn" data-minutes="15">Long Break (15 min)</button>
                        </div>
                    </div>
                </div>

                <!-- Tabs for Content -->
                <div class="tabs-section">
                    <div class="tabs">
                        <div class="tab active" data-tab="learning">Learning Path</div>
                        <div class="tab" data-tab="assessments">Adaptive Quiz</div>
                        <div class="tab" data-tab="resources">Resources</div>
                    </div>

                    <!-- Learning Path Content -->
                    <div class="tab-content active" id="learning-tab">
                        <div class="learning-path-section">
                            <div class="section-header">
                                <h3>Your AI-Powered Learning Path</h3>
                                <button class="btn btn-outline">
                                    <i class="fas fa-sync-alt"></i> Regenerate Path
                                </button>
                            </div>
                            <p>Your path has been personalized based on your learning style, pace, and goals.</p>

                            <div class="path-container">
                                <div class="path-card">
                                    <h4>Data Science Fundamentals</h4>
                                    <p>Master the basics of data analysis and visualization</p>
                                    <div class="path-progress">
                                        <div class="progress-bar">
                                            <div class="progress" style="width: 80%"></div>
                                        </div>
                                        <span>8/10 modules</span>
                                    </div>
                                </div>
                                <div class="path-card">
                                    <h4>Machine Learning Concepts</h4>
                                    <p>Introduction to algorithms and model training</p>
                                    <div class="path-progress">
                                        <div class="progress-bar">
                                            <div class="progress" style="width: 40%"></div>
                                        </div>
                                        <span>4/12 modules</span>
                                    </div>
                                </div>
                                <div class="path-card">
                                    <h4>Advanced Python Programming</h4>
                                    <p>Deep dive into Python for data science</p>
                                    <div class="path-progress">
                                        <div class="progress-bar">
                                            <div class="progress" style="width: 25%"></div>
                                        </div>
                                        <span>3/15 modules</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Adaptive Quiz Content -->
                    <div class="tab-content" id="assessments-tab">
                        <div class="interactive-quiz">
                            <h3>Adaptive Knowledge Check</h3>
                            <p>This quiz adjusts difficulty based on your responses to accurately assess your
                                understanding.</p>

                            <div id="quizContainer">
                                <div class="quiz-question" id="questionText">
                                    What is the time complexity of a binary search algorithm on a sorted array?
                                </div>
                                <div class="quiz-options" id="optionsContainer">
                                    <div class="quiz-option" data-correct="true">O(log n)</div>
                                    <div class="quiz-option" data-correct="false">O(n)</div>
                                    <div class="quiz-option" data-correct="false">O(n log n)</div>
                                    <div class="quiz-option" data-correct="false">O(1)</div>
                                </div>
                                <button class="btn btn-primary" id="submitAnswerBtn">Submit Answer</button>

                                <div class="quiz-feedback" id="quizFeedback">
                                    <!-- Feedback will be inserted here -->
                                </div>

                                <div class="quiz-stats"
                                    style="margin-top: 20px; font-size: 0.9rem; color: var(--gray);">
                                    <p>Adaptive Difficulty: <span id="difficultyLevel">Medium</span></p>
                                    <p>Performance Score: <span id="performanceScore">85%</span></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Resources Content -->
                    <div class="tab-content" id="resources-tab">
                        <div class="learning-path-section">
                            <h3>Personalized Learning Resources</h3>
                            <p>Based on your learning patterns, we recommend these resources:</p>
                            <div class="path-container">
                                <div class="path-card">
                                    <h4><i class="fas fa-video"></i> Interactive Video</h4>
                                    <p>Neural Networks Explained Visually</p>
                                    <span class="ai-tag">AI Recommended</span>
                                </div>
                                <div class="path-card">
                                    <h4><i class="fas fa-file-alt"></i> Study Guide</h4>
                                    <p>Python Data Structures Cheat Sheet</p>
                                    <span class="ai-tag">Matches Your Pace</span>
                                </div>
                                <div class="path-card">
                                    <h4><i class="fas fa-users"></i> Study Group</h4>
                                    <p>Join "Advanced ML Concepts" group</p>
                                    <span class="ai-tag">Collaborative Learning</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Right Sidebar -->
            <aside class="right-sidebar">
                <!-- AI Recommendations -->
                <div class="ai-recommendations">
                    <h3><i class="fas fa-robot"></i> AI Recommendations</h3>
                    <p>Based on your learning patterns, we suggest:</p>

                    <div class="ai-recommendation">
                        <h4>Switch to visual learning</h4>
                        <p>You perform better with diagrams and videos. Try the visual learning mode for your next
                            lesson.</p>
                    </div>

                    <div class="ai-recommendation">
                        <h4>Review probability concepts</h4>
                        <p>Our system detected a slight dip in your probability understanding. Consider reviewing module
                            4.2.</p>
                    </div>

                    <div class="ai-recommendation">
                        <h4>Take a break</h4>
                        <p>You've been studying for 45 minutes. Consider a 5-minute break to maintain optimal focus.</p>
                    </div>
                </div>
            </aside>
        </div>

        <!-- TODO LIST PAGE - ENHANCED WITH DASHBOARD FUNCTIONALITY -->
        <div class="todo-page" id="todoPage">
            <div class="todo-page-header">
                <h2><i class="fas fa-tasks"></i> Daily Tasks Manager</h2>
                <div>
                    <button class="btn btn-outline" id="backToDashboardBtn">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    <button class="btn btn-primary" id="toggleViewBtn">
                        <i class="fas fa-exchange-alt"></i> Switch View
                    </button>
                </div>
            </div>

            <div class="todo-page-content">
                <!-- Stats Cards -->
                <div class="todo-page-stats">
                    <div class="todo-stat-card">
                        <span class="stat-number" id="totalTasksStat">0</span>
                        <span>Total Tasks</span>
                    </div>
                    <div class="todo-stat-card completed">
                        <span class="stat-number" id="completedTasksStat">0</span>
                        <span>Completed</span>
                    </div>
                    <div class="todo-stat-card pending">
                        <span class="stat-number" id="pendingTasksStat">0</span>
                        <span>Pending</span>
                    </div>
                    <div class="todo-stat-card high-priority">
                        <span class="stat-number" id="highPriorityStat">0</span>
                        <span>High Priority</span>
                    </div>
                </div>

                <!-- Progress Bar (From Dashboard) -->
                <div class="todo-stats" style="margin-bottom: 25px;">
                    <span id="taskStats">0/0 tasks completed</span>
                    <div class="todo-progress">
                        <div class="progress-bar">
                            <div class="progress" id="todoProgress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Simple Input Section (From Dashboard) -->
                <div class="todo-input-container" style="margin-bottom: 30px;">
                    <input type="text" id="todoInput" placeholder="Add a new task..." maxlength="100">
                    <button class="btn btn-primary" id="addTodoBtn">
                        <i class="fas fa-plus"></i> Add Task
                    </button>
                </div>

                <!-- Simple Filters (From Dashboard) -->
                <div class="todo-filters" style="margin-bottom: 25px;">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                    <button class="filter-btn" data-filter="high">High Priority</button>
                </div>

                <!-- Simple Todo List (From Dashboard) -->
                <div class="todo-items-container" id="todoItemsContainer" style="max-height: 400px;">
                    <div class="no-tasks-message" id="noTasksMessage">
                        <i class="fas fa-clipboard-list"></i>
                        <p>No tasks yet. Add your first task above!</p>
                    </div>
                </div>

                <!-- Advanced Input Section (Initially Hidden) -->
                <div class="todo-advanced-input" id="advancedInputSection" style="display: none;">
                    <div class="input-group">
                        <label for="todoPageInput">Task Description</label>
                        <input type="text" id="todoPageInput" class="todo-page-input" placeholder="Enter task description..." maxlength="150">
                    </div>
                    <div class="input-group">
                        <label for="todoCategory">Category</label>
                        <select id="todoCategory" class="todo-page-input">
                            <option value="study">Study</option>
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                            <option value="health">Health</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="todoPriority">Priority</label>
                        <select id="todoPriority" class="todo-page-input">
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="todoDueDate">Due Date</label>
                        <input type="date" id="todoDueDate" class="todo-page-input">
                    </div>
                    <div class="input-group" style="align-self: flex-end;">
                        <button class="btn btn-primary" id="addTodoPageBtn" style="height: 44px;">
                            <i class="fas fa-plus"></i> Add Task
                        </button>
                    </div>
                </div>

                <!-- Advanced Filters (Initially Hidden) -->
                <div class="todo-page-filters-advanced" id="advancedFilters" style="display: none; margin-bottom: 25px;">
                    <div class="filter-group">
                        <label for="sortTasks">Sort by:</label>
                        <select id="sortTasks" class="todo-page-input" style="width: auto;">
                            <option value="date">Newest First</option>
                            <option value="priority">Priority</option>
                            <option value="due">Due Date</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterCategory">Category:</label>
                        <select id="filterCategory" class="todo-page-input" style="width: auto;">
                            <option value="all">All Categories</option>
                            <option value="study">Study</option>
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                        </select>
                    </div>
                </div>

                <!-- Advanced Todo Items Container (Initially Hidden) -->
                <div class="todo-page-items-container" id="todoPageItemsContainer" style="display: none; max-height: 400px;">
                    <div class="todo-page-no-tasks" id="todoPageNoTasks">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>No tasks yet</h3>
                        <p>Add your first task using the form above</p>
                    </div>
                </div>

                <!-- Legend -->
                <div class="todo-page-legend">
                    <div class="legend-item">
                        <div class="legend-color legend-high"></div>
                        <span>High Priority</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-medium"></div>
                        <span>Medium Priority</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-low"></div>
                        <span>Low Priority</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-completed"></div>
                        <span>Completed</span>
                    </div>
                </div>
                
                <div class="todo-hints" style="margin-top: 25px;">
                    <p><i class="fas fa-lightbulb"></i> <strong>Pro Tip:</strong> Click on the "Switch View" button to toggle between simple and advanced task management</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Configuration Modal -->
    <div class="modal-overlay" id="testConfigModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Test Configuration</h3>
                <button class="modal-close" id="closeConfigModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="config-section">
                    <h4>Number of Questions</h4>
                    <div class="config-options">
                        <div class="config-option active" data-questions="10">10</div>
                        <div class="config-option" data-questions="20">20</div>
                        <div class="config-option" data-questions="30">30</div>
                        <div class="config-option" data-questions="50">50</div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Time Limit (minutes)</h4>
                    <div class="time-options">
                        <div class="time-option active" data-time="0">No Limit</div>
                        <div class="time-option" data-time="30">30</div>
                        <div class="time-option" data-time="60">60</div>
                        <div class="time-option" data-time="90">90</div>
                    </div>
                </div>

                <div class="config-section">
                    <h4>Select Subjects</h4>
                    <div class="subject-grid">
                        <label class="subject-checkbox">
                            <input type="checkbox" checked data-subject="javascript"> JavaScript
                        </label>
                        <label class="subject-checkbox">
                            <input type="checkbox" checked data-subject="python"> Python
                        </label>
                        <label class="subject-checkbox">
                            <input type="checkbox" checked data-subject="html"> HTML
                        </label>
                        <label class="subject-checkbox">
                            <input type="checkbox" checked data-subject="css"> CSS
                        </label>
                        <label class="subject-checkbox">
                            <input type="checkbox" checked data-subject="react"> React
                        </label>
                        <label class="subject-checkbox">
                            <input type="checkbox" data-subject="c"> C Language
                        </label>
                        <label class="subject-checkbox">
                            <input type="checkbox" data-subject="algorithms"> Algorithms
                        </label>
                        <label class="subject-checkbox">
                            <input type="checkbox" data-subject="datastructures"> Data Structures
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelTestBtn">Cancel</button>
                <button class="btn btn-primary" id="startTestBtn">Start Test</button>
            </div>
        </div>
    </div>

    <!-- Test Interface -->
    <div class="container" id="testContainer">
        <div class="test-interface">
            <div class="test-header">
                <h2><i class="fas fa-file-alt"></i> Skill Assessment Test</h2>
                <div class="test-meta">
                    <div>Question: <span id="currentQuestionNum">1</span>/<span id="totalQuestionsNum">20</span></div>
                    <div class="test-timer" id="testTimer">30:00</div>
                    <div>Score: <span id="currentScore">0</span></div>
                </div>
            </div>

            <div class="test-body">
                <div class="question-section">
                    <div class="question-number">
                        <i class="fas fa-question-circle"></i> Question <span id="qNum">1</span>
                    </div>
                    <div class="question-text" id="questionDisplay">
                        Loading question...
                    </div>

                    <div class="options-container" id="optionsDisplay">
                        <!-- Options will be dynamically inserted here -->
                    </div>

                    <div class="question-dots" id="questionDots">
                        <!-- Question navigation dots will be inserted here -->
                    </div>
                </div>

                <div class="test-controls">
                    <div class="test-actions">
                        <button class="btn btn-outline" id="pauseTestBtn">
                            <i class="fas fa-pause"></i> Pause
                        </button>
                        <button class="btn btn-danger" id="endTestBtn">
                            <i class="fas fa-stop"></i> End Test
                        </button>
                    </div>

                    <div class="question-nav">
                        <button class="nav-btn" id="prevBtn" disabled>
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="nav-btn" id="nextBtn">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Assistant Modal -->
    <div class="modal-overlay" id="aiAssistantModal">
        <div class="ai-modal-content">
            <div class="ai-modal-header">
                <div class="ai-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div>
                    <h3>AI Learning Assistant</h3>
                    <p>Let me help you understand this better</p>
                </div>
                <button class="ai-modal-close" id="closeAIModal">&times;</button>
            </div>
            <div class="ai-modal-body">
                <div class="answer-review">
                    <h4>Question Review</h4>
                    <p id="aiQuestionText"></p>
                    <p>Your answer: <span class="wrong-answer" id="userAnswerText"></span></p>
                    <p>Correct answer: <span class="correct-answer" id="correctAnswerText"></span></p>
                </div>

                <div class="ai-explanation">
                    <h4><i class="fas fa-lightbulb"></i> Detailed Explanation</h4>
                    <p id="aiExplanationText"></p>
                </div>

                <div class="ai-tips">
                    <h4><i class="fas fa-graduation-cap"></i> Learning Tips</h4>
                    <ul id="aiTipsList">
                        <!-- Tips will be added here -->
                    </ul>
                </div>
            </div>
            <div class="ai-modal-footer">
                <button class="btn btn-outline" id="continueBtn">Continue Test</button>
                <button class="btn btn-primary" id="practiceMoreBtn">Practice Similar Questions</button>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal-overlay" id="resultsModal">
        <div class="results-content">
            <div class="results-header">
                <h2><i class="fas fa-trophy"></i> Test Completed!</h2>
                <p>Here's your performance analysis</p>
            </div>
            <div class="results-body">
                <div class="score-display">
                    <div class="score-circle">
                        <span id="finalScore">75</span>%
                    </div>
                    <h3>Your Score: <span id="scoreText">15</span>/<span id="totalText">20</span></h3>
                </div>

                <div class="results-grid">
                    <div class="result-stat">
                        <h4>Time Taken</h4>
                        <p id="timeTakenText">28:45</p>
                    </div>
                    <div class="result-stat">
                        <h4>Accuracy</h4>
                        <p id="accuracyText">75%</p>
                    </div>
                    <div class="result-stat">
                        <h4>Strongest Subject</h4>
                        <p id="strongSubject">JavaScript</p>
                    </div>
                    <div class="result-stat">
                        <h4>Needs Improvement</h4>
                        <p id="weakSubject">Algorithms</p>
                    </div>
                </div>
            </div>
            <div class="results-footer">
                <button class="btn btn-outline" id="closeResultsBtn">Back to Dashboard</button>
                <button class="btn btn-primary" id="reviewWrongBtn">Review Wrong Answers</button>
                <button class="btn btn-success" id="retakeTestBtn">Retake Test</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>LearnSmart AI &copy; 2023 - EdTech 2.0 Platform for Smarter Learning</p>
            <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
                Personalized Learning | Adaptive Assessment | Productivity Tools
            </p>
        </div>
    </footer>

    <script>
        // Focus Timer (Centered) - Updated for 30 minute default
        let timerIntervalCenter;
        let timerSecondsCenter = 30 * 60; // 30 minutes in seconds
        let isTimerRunningCenter = false;

        const timerDisplayCenter = document.getElementById('timerDisplayCenter');
        const startTimerBtnCenter = document.getElementById('startTimerBtnCenter');
        const pauseTimerBtnCenter = document.getElementById('pauseTimerBtnCenter');
        const resetTimerBtnCenter = document.getElementById('resetTimerBtnCenter');
        const decreaseTimeBtn = document.getElementById('decreaseTime');
        const increaseTimeBtn = document.getElementById('increaseTime');
        const timerModeBtns = document.querySelectorAll('.timer-mode-btn');

        function updateTimerDisplayCenter() {
            const minutes = Math.floor(timerSecondsCenter / 60);
            const seconds = timerSecondsCenter % 60;
            timerDisplayCenter.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            // Change color when time is running low
            if (timerSecondsCenter < 60) {
                timerDisplayCenter.style.color = '#ef4444'; // Red
            } else if (timerSecondsCenter < 300) {
                timerDisplayCenter.style.color = '#f59e0b'; // Orange
            } else {
                timerDisplayCenter.style.color = '#4361ee'; // Blue
            }
        }

        // Initialize display
        updateTimerDisplayCenter();

        // Time adjustment buttons
        decreaseTimeBtn.addEventListener('click', function () {
            if (!isTimerRunningCenter && timerSecondsCenter > 60) { // Minimum 1 minute
                timerSecondsCenter -= 60; // Decrease by 1 minute
                updateTimerDisplayCenter();
            }
        });

        increaseTimeBtn.addEventListener('click', function () {
            if (!isTimerRunningCenter && timerSecondsCenter < 60 * 60) { // Maximum 60 minutes
                timerSecondsCenter += 60; // Increase by 1 minute
                updateTimerDisplayCenter();
            }
        });

        // Timer mode buttons
        timerModeBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                if (!isTimerRunningCenter) {
                    // Remove active class from all buttons
                    timerModeBtns.forEach(b => b.classList.remove('active'));

                    // Add active class to clicked button
                    this.classList.add('active');

                    // Set timer to selected mode
                    const minutes = parseInt(this.dataset.minutes);
                    timerSecondsCenter = minutes * 60;
                    updateTimerDisplayCenter();
                }
            });
        });

        // Start timer
        startTimerBtnCenter.addEventListener('click', function () {
            if (!isTimerRunningCenter) {
                isTimerRunningCenter = true;
                startTimerBtnCenter.style.display = 'none';
                pauseTimerBtnCenter.style.display = 'inline-block';

                timerIntervalCenter = setInterval(() => {
                    timerSecondsCenter--;
                    updateTimerDisplayCenter();

                    if (timerSecondsCenter <= 0) {
                        clearInterval(timerIntervalCenter);
                        isTimerRunningCenter = false;
                        startTimerBtnCenter.style.display = 'inline-block';
                        pauseTimerBtnCenter.style.display = 'none';

                        // Play notification sound (if available) or show alert
                        alert("Time's up! Take a break.");

                        // Auto-switch to short break if in focus mode
                        const activeMode = document.querySelector('.timer-mode-btn.active');
                        if (activeMode && activeMode.dataset.minutes === "30") {
                            document.querySelector('.timer-mode-btn[data-minutes="5"]').click();
                        }
                    }
                }, 1000);
            }
        });

        // Pause timer
        pauseTimerBtnCenter.addEventListener('click', function () {
            if (isTimerRunningCenter) {
                clearInterval(timerIntervalCenter);
                isTimerRunningCenter = false;
                startTimerBtnCenter.style.display = 'inline-block';
                pauseTimerBtnCenter.style.display = 'none';
            }
        });

        // Reset timer
        resetTimerBtnCenter.addEventListener('click', function () {
            clearInterval(timerIntervalCenter);
            isTimerRunningCenter = false;
            startTimerBtnCenter.style.display = 'inline-block';
            pauseTimerBtnCenter.style.display = 'none';

            // Reset to active mode's time
            const activeMode = document.querySelector('.timer-mode-btn.active');
            if (activeMode) {
                const minutes = parseInt(activeMode.dataset.minutes);
                timerSecondsCenter = minutes * 60;
            } else {
                timerSecondsCenter = 30 * 60; // Default to 30 minutes
            }

            updateTimerDisplayCenter();
        });

        // Test Configuration and State
        let testConfig = {
            questions: 20,
            timeLimit: 30,
            subjects: ['javascript', 'python', 'html', 'css', 'react']
        };

        let testState = {
            currentQuestion: 0,
            answers: [],
            startTime: null,
            timerInterval: null,
            timeRemaining: 0,
            isPaused: false,
            questions: [],
            score: 0,
            totalTime: 0
        };

        // Expanded Questions Database with 50+ questions per subject
        const questionsDatabase = {
            javascript: [
                {
                    question: "What will be the output of: console.log(1 + '2' + '2')?",
                    options: ["'122'", "'32'", "5", "NaN"],
                    correct: 0,
                    explanation: "JavaScript performs string concatenation when a string is involved. 1 + '2' becomes '12', then '12' + '2' becomes '122'.",
                    tips: ["Remember type coercion in JavaScript", "Number + String results in string concatenation"]
                },
                {
                    question: "What is the difference between let and var?",
                    options: ["let has block scope, var has function scope", "let is hoisted, var is not", "var is newer than let", "No difference"],
                    correct: 0,
                    explanation: "Variables declared with let are block-scoped, while var declarations are function-scoped. let also doesn't allow redeclaration in the same scope.",
                    tips: ["Use let for better scoping control", "Avoid var in modern JavaScript"]
                }
            ],
            python: [
                {
                    question: "What does the 'self' parameter represent in Python class methods?",
                    options: ["The class itself", "The instance of the class", "A static method", "A class variable"],
                    correct: 1,
                    explanation: "The self parameter refers to the instance of the class. It's used to access attributes and methods of the class.",
                    tips: ["Always include self as first parameter in instance methods", "self is a convention, not a keyword"]
                }
            ],
            html: [
                {
                    question: "Which HTML5 element represents the main content of a document?",
                    options: ["<main>", "<content>", "<body>", "<section>"],
                    correct: 0,
                    explanation: "The <main> element represents the dominant content of the <body> of a document.",
                    tips: ["Use <main> for primary content", "Only one <main> element per page"]
                }
            ],
            css: [
                {
                    question: "What does CSS specificity determine?",
                    options: ["The order of CSS rules", "Which CSS rule is applied when conflicts occur", "The performance of CSS", "The browser compatibility"],
                    correct: 1,
                    explanation: "CSS specificity determines which CSS rule is applied by browsers when multiple rules could apply to the same element.",
                    tips: ["ID selectors have highest specificity", "Inline styles override external styles"]
                }
            ],
            react: [
                {
                    question: "What is the purpose of React hooks?",
                    options: ["To connect to APIs", "To use state and other React features in functional components", "To style components", "To optimize performance"],
                    correct: 1,
                    explanation: "Hooks let you use state and other React features without writing a class component.",
                    tips: ["Only call hooks at the top level", "Only call hooks from React functions"]
                }
            ],
            c: [
                {
                    question: "What is the size of an integer in C?",
                    options: ["2 bytes", "4 bytes", "Depends on the compiler", "Always 8 bytes"],
                    correct: 2,
                    explanation: "The size of an integer in C is implementation-dependent and varies by compiler and architecture.",
                    tips: ["Use sizeof() operator to check size", "Don't assume fixed sizes for portability"]
                }
            ],
            algorithms: [
                {
                    question: "What is the time complexity of bubble sort in worst case?",
                    options: ["O(n)", "O(n log n)", "O(n)", "O(1)"],
                    correct: 2,
                    explanation: "Bubble sort has O(n) time complexity in worst case as it makes n-1 passes with n-1 comparisons each.",
                    tips: ["Bubble sort is inefficient for large datasets", "Consider quicksort or mergesort for better performance"]
                }
            ],
            datastructures: [
                {
                    question: "What is the main advantage of a hash table?",
                    options: ["Sorted data", "Constant time average case lookup", "Memory efficiency", "Easy implementation"],
                    correct: 1,
                    explanation: "Hash tables provide O(1) average case time complexity for search, insert, and delete operations.",
                    tips: ["Choose good hash functions", "Consider load factor for efficiency"]
                }
            ]
        };

        // DOM Elements for page switching
        const dashboardLink = document.getElementById('dashboardLink');
        const dailyTasksLink = document.getElementById('dailyTasksLink');
        const mainDashboard = document.getElementById('mainDashboard');
        const todoPage = document.getElementById('todoPage');
        const backToDashboardBtn = document.getElementById('backToDashboardBtn');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function () {
            // Setup page switching
            dashboardLink.addEventListener('click', function(e) {
                e.preventDefault();
                showDashboard();
            });

            dailyTasksLink.addEventListener('click', function(e) {
                e.preventDefault();
                showTodoPage();
            });

            backToDashboardBtn.addEventListener('click', function() {
                showDashboard();
            });

            // Setup test navigation button
            document.getElementById('testNavBtn').addEventListener('click', function (e) {
                e.preventDefault();
                openTestConfig();
            });

            // Setup test configuration modal
            setupTestConfigModal();

            // Setup existing dashboard functionality
            setupDashboard();

            // Initialize todo list (moved to daily tasks page)
            initializeTodoList();
        });

        function showDashboard() {
            mainDashboard.style.display = 'grid';
            todoPage.style.display = 'none';
            // Update active states in navigation
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
            });
            dashboardLink.classList.add('active');
        }

        function showTodoPage() {
            mainDashboard.style.display = 'none';
            todoPage.style.display = 'block';
            // Update active states in navigation
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
            });
            // Refresh todo page
            if (window.updateTodoStats) {
                window.updateTodoStats();
            }
            // Make sure we're in simple view when opening the page
            const toggleBtn = document.getElementById('toggleViewBtn');
            if (toggleBtn && window.isAdvancedView === true) {
                // If already in advanced view, switch to simple view
                toggleView();
            } else if (toggleBtn) {
                toggleBtn.innerHTML = '<i class="fas fa-exchange-alt"></i> Switch to Advanced View';
            }
            // Refresh the todo list display
            if (window.todos && window.todos.length > 0) {
                if (window.isAdvancedView) {
                    if (window.renderTodoPageItems) window.renderTodoPageItems();
                } else {
                    if (window.renderTodos) window.renderTodos();
                }
            }
        }

        function openTestConfig() {
            document.getElementById('testConfigModal').style.display = 'flex';
        }

        function setupTestConfigModal() {
            const closeConfigBtn = document.getElementById('closeConfigModal');
            const cancelTestBtn = document.getElementById('cancelTestBtn');
            const startTestBtn = document.getElementById('startTestBtn');
            const configOptions = document.querySelectorAll('.config-option');
            const timeOptions = document.querySelectorAll('.time-option');
            const subjectCheckboxes = document.querySelectorAll('.subject-checkbox input');

            // Close modal events
            closeConfigBtn.addEventListener('click', closeTestConfig);
            cancelTestBtn.addEventListener('click', closeTestConfig);

            // Click outside to close
            document.getElementById('testConfigModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('testConfigModal')) {
                    closeTestConfig();
                }
            });

            // Configuration options
            configOptions.forEach(option => {
                option.addEventListener('click', () => {
                    configOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    testConfig.questions = parseInt(option.dataset.questions);
                });
            });

            timeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    timeOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    testConfig.timeLimit = parseInt(option.dataset.time);
                });
            });

            // Start test button
            startTestBtn.addEventListener('click', () => {
                // Get selected subjects
                const selectedSubjects = [];
                subjectCheckboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        selectedSubjects.push(checkbox.dataset.subject);
                    }
                });

                if (selectedSubjects.length === 0) {
                    alert('Please select at least one subject!');
                    return;
                }

                testConfig.subjects = selectedSubjects;
                closeTestConfig();
                startTest();
            });
        }

        function closeTestConfig() {
            document.getElementById('testConfigModal').style.display = 'none';
        }

        // ===== TODO LIST FUNCTIONALITY (MOVED TO DAILY TASKS PAGE) =====
        function initializeTodoList() {
            // DOM Elements
            const todoInput = document.getElementById('todoInput');
            const addTodoBtn = document.getElementById('addTodoBtn');
            const todoItemsContainer = document.getElementById('todoItemsContainer');
            const noTasksMessage = document.getElementById('noTasksMessage');
            const filterBtns = document.querySelectorAll('.todo-filters .filter-btn');
            const taskStats = document.getElementById('taskStats');
            const todoProgress = document.getElementById('todoProgress');
            
            // Advanced elements
            const todoPageInput = document.getElementById('todoPageInput');
            const addTodoPageBtn = document.getElementById('addTodoPageBtn');
            const todoPageItemsContainer = document.getElementById('todoPageItemsContainer');
            const todoPageNoTasks = document.getElementById('todoPageNoTasks');
            const toggleViewBtn = document.getElementById('toggleViewBtn');
            const advancedInputSection = document.getElementById('advancedInputSection');
            const advancedFilters = document.getElementById('advancedFilters');
            
            // View toggle
            window.isAdvancedView = false;
            
            // Load todos from localStorage or use sample data
            window.todos = JSON.parse(localStorage.getItem('learnsmart_todos')) || [
                {
                    id: 1,
                    text: 'Review Data Science Module 4.2',
                    completed: true,
                    priority: 'high',
                    category: 'study',
                    dueDate: null,
                    createdAt: new Date().getTime() - 86400000
                },
            ];
            
            let currentFilter = 'all';
            let currentSort = 'date';
            let currentCategoryFilter = 'all';
            
            // Initialize display
            renderTodos();
            updateStats();
            
            // Setup view toggle
            toggleViewBtn.addEventListener('click', toggleView);
            
            // Simple view events
            addTodoBtn.addEventListener('click', addTodo);
            todoInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTodo();
                }
            });
            
            // Advanced view events
            addTodoPageBtn.addEventListener('click', addTodoPage);
            todoPageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTodoPage();
                }
            });
            
            // Set default due date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('todoDueDate').valueAsDate = tomorrow;
            
            // Simple filter events
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    if (window.isAdvancedView) {
                        renderTodoPageItems();
                    } else {
                        renderTodos();
                    }
                });
            });
            
            // Advanced sort and filter events
            document.getElementById('sortTasks').addEventListener('change', function() {
                currentSort = this.value;
                renderTodoPageItems();
            });
            
            document.getElementById('filterCategory').addEventListener('change', function() {
                currentCategoryFilter = this.value;
                renderTodoPageItems();
            });
            
            function toggleView() {
                window.isAdvancedView = !window.isAdvancedView;
                
                if (window.isAdvancedView) {
                    // Switch to advanced view
                    todoInput.style.display = 'none';
                    addTodoBtn.style.display = 'none';
                    todoItemsContainer.style.display = 'none';
                    document.querySelector('.todo-stats').style.display = 'none';
                    document.querySelector('.todo-filters').style.display = 'none';
                    advancedInputSection.style.display = 'flex';
                    advancedFilters.style.display = 'flex';
                    todoPageItemsContainer.style.display = 'block';
                    
                    toggleViewBtn.innerHTML = '<i class="fas fa-exchange-alt"></i> Switch to Simple View';
                    renderTodoPageItems();
                } else {
                    // Switch to simple view
                    todoInput.style.display = 'block';
                    addTodoBtn.style.display = 'block';
                    todoItemsContainer.style.display = 'block';
                    document.querySelector('.todo-stats').style.display = 'flex';
                    document.querySelector('.todo-filters').style.display = 'flex';
                    advancedInputSection.style.display = 'none';
                    advancedFilters.style.display = 'none';
                    todoPageItemsContainer.style.display = 'none';
                    
                    toggleViewBtn.innerHTML = '<i class="fas fa-exchange-alt"></i> Switch to Advanced View';
                    renderTodos();
                }
            }
            
            function addTodo() {
                const text = todoInput.value.trim();
                if (!text) return;
                
                const newTodo = {
                    id: Date.now(),
                    text: text,
                    completed: false,
                    priority: 'medium',
                    category: 'study',
                    dueDate: null,
                    createdAt: new Date().getTime()
                };
                
                window.todos.unshift(newTodo);
                saveTodos();
                renderTodos();
                updateStats();
                
                // Clear input
                todoInput.value = '';
                
                // Show notification
                showNotification('Task added successfully!');
            }
            
            function addTodoPage() {
                const text = todoPageInput.value.trim();
                if (!text) {
                    alert('Please enter a task description');
                    return;
                }
                
                const category = document.getElementById('todoCategory').value;
                const priority = document.getElementById('todoPriority').value;
                const dueDate = document.getElementById('todoDueDate').value ? 
                    new Date(document.getElementById('todoDueDate').value).getTime() : null;
                
                const newTodo = {
                    id: Date.now(),
                    text: text,
                    completed: false,
                    priority: priority,
                    category: category,
                    dueDate: dueDate,
                    createdAt: new Date().getTime()
                };
                
                window.todos.unshift(newTodo);
                saveTodos();
                renderTodoPageItems();
                updateStats();
                
                // Clear input
                todoPageInput.value = '';
                
                // Show notification
                showNotification('Task added successfully!');
            }
            
            function renderTodos() {
                const filteredTodos = filterTodos(window.todos, currentFilter);
                
                if (filteredTodos.length === 0) {
                    noTasksMessage.style.display = 'block';
                    todoItemsContainer.innerHTML = '';
                    todoItemsContainer.appendChild(noTasksMessage);
                    return;
                }
                
                noTasksMessage.style.display = 'none';
                
                // Sort todos: incomplete first, then by priority, then by date
                const sortedTodos = [...filteredTodos].sort((a, b) => {
                    // Completed status first
                    if (a.completed !== b.completed) {
                        return a.completed ? 1 : -1;
                    }
                    
                    // Then by priority (high to low)
                    const priorityOrder = { high: 0, medium: 1, low: 2 };
                    if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
                        return priorityOrder[a.priority] - priorityOrder[b.priority];
                    }
                    
                    // Then by creation date (newest first)
                    return b.createdAt - a.createdAt;
                });
                
                todoItemsContainer.innerHTML = '';
                
                sortedTodos.forEach(todo => {
                    const todoElement = createTodoElement(todo);
                    todoItemsContainer.appendChild(todoElement);
                });
            }
            
            function renderTodoPageItems() {
                if (window.todos.length === 0) {
                    todoPageNoTasks.style.display = 'block';
                    todoPageItemsContainer.innerHTML = '';
                    todoPageItemsContainer.appendChild(todoPageNoTasks);
                    return;
                }
                
                todoPageNoTasks.style.display = 'none';
                
                // Filter todos
                let filteredTodos = [...window.todos];
                
                // Apply status filter from simple filters
                if (currentFilter === 'pending') {
                    filteredTodos = filteredTodos.filter(todo => !todo.completed);
                } else if (currentFilter === 'completed') {
                    filteredTodos = filteredTodos.filter(todo => todo.completed);
                } else if (currentFilter === 'high') {
                    filteredTodos = filteredTodos.filter(todo => todo.priority === 'high');
                }
                
                // Apply category filter
                if (currentCategoryFilter !== 'all') {
                    filteredTodos = filteredTodos.filter(todo => todo.category === currentCategoryFilter);
                }
                
                // Sort todos
                filteredTodos.sort((a, b) => {
                    if (currentSort === 'priority') {
                        const priorityOrder = { high: 0, medium: 1, low: 2 };
                        return priorityOrder[a.priority] - priorityOrder[b.priority];
                    } else if (currentSort === 'due') {
                        if (!a.dueDate && !b.dueDate) return 0;
                        if (!a.dueDate) return 1;
                        if (!b.dueDate) return -1;
                        return a.dueDate - b.dueDate;
                    } else {
                        // Default: sort by date (newest first)
                        return b.createdAt - a.createdAt;
                    }
                });
                
                todoPageItemsContainer.innerHTML = '';
                
                filteredTodos.forEach(todo => {
                    const todoElement = createTodoPageElement(todo);
                    todoPageItemsContainer.appendChild(todoElement);
                });
            }
            
            function createTodoElement(todo) {
                const todoDiv = document.createElement('div');
                todoDiv.className = `todo-item ${todo.completed ? 'completed' : ''} ${todo.priority === 'high' ? 'high-priority' : ''}`;
                todoDiv.dataset.id = todo.id;
                
                const timeAgo = getTimeAgo(todo.createdAt);
                
                todoDiv.innerHTML = `
                    <div class="todo-checkbox">
                        <input type="checkbox" ${todo.completed ? 'checked' : ''} id="todo-${todo.id}">
                    </div>
                    <div class="todo-content">
                        <div class="todo-text">${todo.text}</div>
                        <div class="todo-meta">
                            <span class="todo-priority priority-${todo.priority}">${todo.priority.charAt(0).toUpperCase() + todo.priority.slice(1)}</span>
                            <span class="todo-time">${timeAgo}</span>
                        </div>
                    </div>
                    <div class="todo-actions">
                        <button class="todo-action-btn edit-btn" title="Edit task">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="todo-action-btn delete-btn" title="Delete task">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                // Add event listeners
                const checkbox = todoDiv.querySelector(`#todo-${todo.id}`);
                const editBtn = todoDiv.querySelector('.edit-btn');
                const deleteBtn = todoDiv.querySelector('.delete-btn');
                
                checkbox.addEventListener('change', function() {
                    toggleTodoComplete(todo.id, this.checked);
                });
                
                editBtn.addEventListener('click', function() {
                    editTodo(todo.id);
                });
                
                deleteBtn.addEventListener('click', function() {
                    deleteTodo(todo.id);
                });
                
                return todoDiv;
            }
            
            function createTodoPageElement(todo) {
                const todoDiv = document.createElement('div');
                todoDiv.className = `todo-page-item ${todo.completed ? 'completed' : ''} ${todo.priority}-priority`;
                todoDiv.dataset.id = todo.id;
                
                // Format due date
                let dueDateText = 'No due date';
                if (todo.dueDate) {
                    const dueDate = new Date(todo.dueDate);
                    const today = new Date();
                    const tomorrow = new Date();
                    tomorrow.setDate(today.getDate() + 1);
                    
                    if (dueDate.toDateString() === today.toDateString()) {
                        dueDateText = 'Today';
                    } else if (dueDate.toDateString() === tomorrow.toDateString()) {
                        dueDateText = 'Tomorrow';
                    } else {
                        dueDateText = dueDate.toLocaleDateString('en-US', { 
                            month: 'short', 
                            day: 'numeric',
                            year: dueDate.getFullYear() !== today.getFullYear() ? 'numeric' : undefined
                        });
                    }
                }
                
                // Format category display
                const categoryText = todo.category.charAt(0).toUpperCase() + todo.category.slice(1);
                
                todoDiv.innerHTML = `
                    <div class="todo-page-checkbox">
                        <input type="checkbox" ${todo.completed ? 'checked' : ''} id="todo-page-${todo.id}">
                    </div>
                    <div class="todo-page-text">${todo.text}</div>
                    <div class="todo-page-category">${categoryText}</div>
                    <div class="todo-page-due-date">${dueDateText}</div>
                    <div class="todo-page-actions">
                        <button class="todo-page-action-btn todo-page-edit-btn" title="Edit task">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="todo-page-action-btn todo-page-delete-btn" title="Delete task">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                // Add event listeners
                const checkbox = todoDiv.querySelector(`#todo-page-${todo.id}`);
                const editBtn = todoDiv.querySelector('.todo-page-edit-btn');
                const deleteBtn = todoDiv.querySelector('.todo-page-delete-btn');
                
                checkbox.addEventListener('change', function() {
                    toggleTodoComplete(todo.id, this.checked);
                });
                
                editBtn.addEventListener('click', function() {
                    editTodo(todo.id);
                });
                
                deleteBtn.addEventListener('click', function() {
                    deleteTodo(todo.id);
                });
                
                return todoDiv;
            }
            
            function toggleTodoComplete(id, completed) {
                const todoIndex = window.todos.findIndex(todo => todo.id === id);
                if (todoIndex !== -1) {
                    window.todos[todoIndex].completed = completed;
                    window.todos[todoIndex].completedAt = completed ? new Date().getTime() : null;
                    saveTodos();
                    
                    if (window.isAdvancedView) {
                        renderTodoPageItems();
                    } else {
                        renderTodos();
                    }
                    
                    updateStats();
                    
                    // Add animation
                    const todoElement = document.querySelector(`[data-id="${id}"]`);
                    if (todoElement) {
                        todoElement.classList.add('completed-animation');
                        setTimeout(() => {
                            todoElement.classList.remove('completed-animation');
                        }, 500);
                    }
                    
                    // Show notification
                    if (completed) {
                        showNotification('Task completed! Great job! ');
                    }
                }
            }
            
            function editTodo(id) {
                const todoIndex = window.todos.findIndex(todo => todo.id === id);
                if (todoIndex === -1) return;
                
                const todo = window.todos[todoIndex];
                
                if (window.isAdvancedView) {
                    // Use advanced edit
                    const newText = prompt('Edit task description:', todo.text);
                    if (newText && newText.trim()) {
                        window.todos[todoIndex].text = newText.trim();
                        saveTodos();
                        renderTodoPageItems();
                        showNotification('Task updated!');
                    }
                } else {
                    // Use simple edit
                    const newText = prompt('Edit task:', todo.text);
                    if (newText && newText.trim()) {
                        window.todos[todoIndex].text = newText.trim();
                        saveTodos();
                        renderTodos();
                        showNotification('Task updated!');
                    }
                }
            }
            
            function deleteTodo(id) {
                if (confirm('Are you sure you want to delete this task?')) {
                    window.todos = window.todos.filter(todo => todo.id !== id);
                    saveTodos();
                    
                    if (window.isAdvancedView) {
                        renderTodoPageItems();
                    } else {
                        renderTodos();
                    }
                    
                    updateStats();
                    showNotification('Task deleted');
                }
            }
            
            function filterTodos(todos, filter) {
                switch(filter) {
                    case 'pending':
                        return todos.filter(todo => !todo.completed);
                    case 'completed':
                        return todos.filter(todo => todo.completed);
                    case 'high':
                        return todos.filter(todo => todo.priority === 'high');
                    default:
                        return todos;
                }
            }
            
            function updateStats() {
                const totalTasks = window.todos.length;
                const completedTasks = window.todos.filter(todo => todo.completed).length;
                const pendingTasks = totalTasks - completedTasks;
                const highPriorityTasks = window.todos.filter(todo => todo.priority === 'high').length;
                const completionPercentage = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
                
                // Update simple stats
                document.getElementById('taskStats').textContent = `${completedTasks}/${totalTasks} tasks completed`;
                document.getElementById('todoProgress').style.width = `${completionPercentage}%`;
                
                // Update progress bar color
                const progressBar = document.getElementById('todoProgress');
                if (completionPercentage >= 80) {
                    progressBar.style.backgroundColor = 'var(--success)';
                } else if (completionPercentage >= 50) {
                    progressBar.style.backgroundColor = 'var(--warning)';
                } else {
                    progressBar.style.backgroundColor = 'var(--primary)';
                }
                
                // Update advanced stats
                document.getElementById('totalTasksStat').textContent = totalTasks;
                document.getElementById('completedTasksStat').textContent = completedTasks;
                document.getElementById('pendingTasksStat').textContent = pendingTasks;
                document.getElementById('highPriorityStat').textContent = highPriorityTasks;
            }
            
            window.saveTodos = function() {
                localStorage.setItem('learnsmart_todos', JSON.stringify(window.todos));
            }
            
            window.updateTodoStats = updateStats;
            window.renderTodos = renderTodos;
            window.renderTodoPageItems = renderTodoPageItems;
            
            function getTimeAgo(timestamp) {
                const now = new Date().getTime();
                const diff = now - timestamp;
                
                const minutes = Math.floor(diff / 60000);
                const hours = Math.floor(diff / 3600000);
                const days = Math.floor(diff / 86400000);
                
                if (minutes < 1) {
                    return 'Just now';
                } else if (minutes < 60) {
                    return `${minutes}m ago`;
                } else if (hours < 24) {
                    return `${hours}h ago`;
                } else if (days === 1) {
                    return 'Yesterday';
                } else {
                    return `${days}d ago`;
                }
            }
            
            function showNotification(message) {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <span>${message}</span>
                `;
                
                document.body.appendChild(notification);
                
                // Remove notification after 3 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOutRight 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }
            
            // Add sample tasks if empty
            if (window.todos.length === 0) {
                const sampleTasks = [
                    'Review today\'s learning materials',
                    'Complete focus timer session',
                    'Check upcoming assignments',
                    'Join weekly study group'
                ];
                
                sampleTasks.forEach((task, index) => {
                    window.todos.push({
                        id: Date.now() + index,
                        text: task,
                        completed: index === 0, // First task completed
                        priority: index === 1 ? 'high' : (index === 2 ? 'medium' : 'low'),
                        category: 'study',
                        dueDate: null,
                        createdAt: new Date().getTime() - (index * 3600000) // Stagger creation times
                    });
                });
                
                saveTodos();
                renderTodos();
                updateStats();
            }
        }

        // Rest of the test functionality remains the same as before
        // (setupDashboard, generateQuestionsForTest, updateQuestionDisplay, etc.)
        // These functions are already in your original code and remain unchanged

        function setupDashboard() {
            // Mobile Menu Toggle
            document.getElementById('mobileMenuBtn').addEventListener('click', function () {
                const nav = document.getElementById('mainNav').querySelector('ul');
                nav.classList.toggle('active');
            });

            // Tab Switching
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));

                    // Add active class to clicked tab
                    tab.classList.add('active');

                    // Show corresponding content
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });

            // Navigation links to switch tabs
            const navLinks = document.querySelectorAll('nav a');
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const tab = link.getAttribute('data-tab');
                    if (tab) {
                        tabs.forEach(t => t.classList.remove('active'));
                        tabContents.forEach(c => c.classList.remove('active'));

                        document.querySelector(`.tab[data-tab="${tab}"]`).classList.add('active');
                        document.getElementById(`${tab}-tab`).classList.add('active');
                    }
                });
            });

            // Existing quiz functionality
            const quizOptions = document.querySelectorAll('.quiz-option');
            const submitBtn = document.getElementById('submitAnswerBtn');
            const quizFeedback = document.getElementById('quizFeedback');

            let selectedOption = null;

            quizOptions.forEach(option => {
                option.addEventListener('click', function () {
                    // Remove selection from all options
                    quizOptions.forEach(opt => opt.classList.remove('selected'));

                    // Select clicked option
                    this.classList.add('selected');
                    selectedOption = this;
                });
            });

            submitBtn.addEventListener('click', function () {
                if (!selectedOption) {
                    alert('Please select an answer first!');
                    return;
                }

                const isCorrect = selectedOption.getAttribute('data-correct') === 'true';

                // Show feedback
                quizFeedback.style.display = 'block';
                quizFeedback.className = `quiz-feedback ${isCorrect ? 'correct' : 'incorrect'}`;

                if (isCorrect) {
                    quizFeedback.innerHTML = `
                        <h4><i class="fas fa-check-circle"></i> Correct!</h4>
                        <p>Binary search has O(log n) time complexity because it halves the search space each iteration.</p>
                    `;
                } else {
                    quizFeedback.innerHTML = `
                        <h4><i class="fas fa-times-circle"></i> Not quite right</h4>
                        <p>The correct answer is O(log n). Binary search eliminates half of the remaining elements with each comparison.</p>
                    `;
                }
            });

            // Start Learning Button
            document.getElementById('startLearningBtn').addEventListener('click', function () {
                // Switch to learning tab
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));

                document.querySelector('.tab[data-tab="learning"]').classList.add('active');
                document.getElementById('learning-tab').classList.add('active');

                // Simulate loading a lesson
                alert("Loading your next lesson: 'Understanding Neural Networks'...");
            });
        }

        // Test functions (remain unchanged from original)
        function startTest() {
            // Generate questions based on selected subjects and requested count
            testState.questions = generateQuestionsForTest();

            if (testState.questions.length < testConfig.questions) {
                alert(`Warning: Only ${testState.questions.length} questions available for selected subjects. Starting with available questions.`);
            }

            testState.currentQuestion = 0;
            testState.answers = new Array(testState.questions.length).fill(null);
            testState.score = 0;
            testState.startTime = new Date();
            testState.timeRemaining = testConfig.timeLimit * 60; // Convert to seconds
            testState.isPaused = false;

            // Show test interface
            document.getElementById('testContainer').style.display = 'block';
            document.querySelector('.dashboard').style.display = 'none';

            // Update UI
            document.getElementById('totalQuestionsNum').textContent = testState.questions.length;
            updateQuestionDisplay();
            setupQuestionDots();
            startTimer();
            setupTestControls();
        }

        function generateQuestionsForTest() {
            let allQuestions = [];

            // For each selected subject, get questions
            testConfig.subjects.forEach(subject => {
                if (questionsDatabase[subject]) {
                    const subjectQuestions = questionsDatabase[subject];

                    // Calculate how many questions to take from this subject
                    // Distribute questions proportionally if multiple subjects selected
                    const questionsPerSubject = Math.ceil(testConfig.questions / testConfig.subjects.length);

                    // Take the required number of questions from this subject
                    // If subject doesn't have enough questions, take all available
                    const questionsToTake = Math.min(questionsPerSubject, subjectQuestions.length);

                    // Shuffle and take questions
                    const shuffled = [...subjectQuestions].sort(() => Math.random() - 0.5);
                    allQuestions.push(...shuffled.slice(0, questionsToTake));
                }
            });

            // Shuffle all questions and take the requested number
            allQuestions = allQuestions.sort(() => Math.random() - 0.5);

            // If we have more questions than requested, trim to requested number
            // If we have fewer, we'll use all available
            return allQuestions.slice(0, Math.min(testConfig.questions, allQuestions.length));
        }

        function updateQuestionDisplay() {
            const question = testState.questions[testState.currentQuestion];
            const questionNum = testState.currentQuestion + 1;

            // Update question number
            document.getElementById('currentQuestionNum').textContent = questionNum;
            document.getElementById('qNum').textContent = questionNum;

            // Update question text
            document.getElementById('questionDisplay').textContent = question.question;

            // Update options
            const optionsContainer = document.getElementById('optionsDisplay');
            optionsContainer.innerHTML = '';

            const letters = ['A', 'B', 'C', 'D'];
            const userAnswer = testState.answers[testState.currentQuestion];

            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.dataset.index = index;

                // Check if this option was selected
                if (userAnswer === index) {
                    optionDiv.classList.add('selected');

                    // If we're reviewing, show correct/incorrect
                    if (testState.isReviewing) {
                        if (index === question.correct) {
                            optionDiv.classList.add('correct');
                        } else {
                            optionDiv.classList.add('incorrect');
                        }
                    }
                }

                // If we're reviewing and this is the correct answer, mark it
                if (testState.isReviewing && index === question.correct) {
                    optionDiv.classList.add('correct');
                }

                optionDiv.innerHTML = `
                    <div class="option-letter">${letters[index]}</div>
                    <div class="option-text">${option}</div>
                `;

                // Only allow selection if not reviewing
                if (!testState.isReviewing) {
                    optionDiv.addEventListener('click', () => selectOption(index));
                }

                optionsContainer.appendChild(optionDiv);
            });

            // Update navigation buttons
            document.getElementById('prevBtn').disabled = testState.currentQuestion === 0;
            document.getElementById('nextBtn').disabled = false;

            if (testState.currentQuestion === testState.questions.length - 1) {
                document.getElementById('nextBtn').textContent = 'Submit Test';
            } else {
                document.getElementById('nextBtn').textContent = 'Next';
            }

            // Update question dots
            updateQuestionDots();
        }

        function selectOption(optionIndex) {
            const currentIndex = testState.currentQuestion;
            testState.answers[currentIndex] = optionIndex;

            // Update UI to show selection
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                option.classList.remove('selected');
                if (index === optionIndex) {
                    option.classList.add('selected');
                }
            });

            // Update question dot
            updateQuestionDots();
        }

        function setupQuestionDots() {
            const dotsContainer = document.getElementById('questionDots');
            dotsContainer.innerHTML = '';

            for (let i = 0; i < testState.questions.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'question-dot';
                dot.textContent = i + 1;
                dot.dataset.index = i;

                if (i === testState.currentQuestion) {
                    dot.classList.add('current');
                } else if (testState.answers[i] !== null) {
                    dot.classList.add('answered');
                } else {
                    dot.classList.add('unanswered');
                }

                dot.addEventListener('click', () => {
                    if (!testState.isReviewing) {
                        testState.currentQuestion = i;
                        updateQuestionDisplay();
                    }
                });

                dotsContainer.appendChild(dot);
            }
        }

        function updateQuestionDots() {
            const dots = document.querySelectorAll('.question-dot');
            dots.forEach((dot, index) => {
                dot.classList.remove('current', 'answered', 'unanswered');

                if (index === testState.currentQuestion) {
                    dot.classList.add('current');
                } else if (testState.answers[index] !== null) {
                    dot.classList.add('answered');
                } else {
                    dot.classList.add('unanswered');
                }
            });
        }

        function startTimer() {
            if (testConfig.timeLimit > 0) {
                updateTimerDisplay();

                testState.timerInterval = setInterval(() => {
                    if (!testState.isPaused) {
                        testState.timeRemaining--;
                        updateTimerDisplay();

                        if (testState.timeRemaining <= 0) {
                            clearInterval(testState.timerInterval);
                            submitTest();
                            alert('Time is up! Test submitted automatically.');
                        }
                    }
                }, 1000);
            } else {
                document.getElementById('testTimer').textContent = 'No Limit';
            }
        }

        function updateTimerDisplay() {
            if (testConfig.timeLimit > 0) {
                const minutes = Math.floor(testState.timeRemaining / 60);
                const seconds = testState.timeRemaining % 60;
                const timerText = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('testTimer').textContent = timerText;

                // Update timer color based on remaining time
                const timerElement = document.getElementById('testTimer');
                if (testState.timeRemaining < 60) {
                    timerElement.style.color = '#ef4444'; // Red for less than 1 minute
                    timerElement.style.fontWeight = 'bold';
                } else if (testState.timeRemaining < 300) {
                    timerElement.style.color = '#f59e0b'; // Orange for less than 5 minutes
                } else {
                    timerElement.style.color = 'white'; // White for normal time
                }
            }
        }

        function setupTestControls() {
            // Previous button
            document.getElementById('prevBtn').addEventListener('click', () => {
                if (testState.currentQuestion > 0) {
                    testState.currentQuestion--;
                    updateQuestionDisplay();
                }
            });

            // Next button
            document.getElementById('nextBtn').addEventListener('click', () => {
                if (testState.currentQuestion < testState.questions.length - 1) {
                    testState.currentQuestion++;
                    updateQuestionDisplay();
                } else {
                    submitTest();
                }
            });

            // Pause button
            document.getElementById('pauseTestBtn').addEventListener('click', togglePause);

            // End test button
            document.getElementById('endTestBtn').addEventListener('click', () => {
                if (confirm('Are you sure you want to end the test? All progress will be lost.')) {
                    endTest();
                }
            });
        }

        function togglePause() {
            const pauseBtn = document.getElementById('pauseTestBtn');

            if (testState.isPaused) {
                // Resume test
                testState.isPaused = false;
                pauseBtn.innerHTML = '<i class="fas fa-pause"></i> Pause';
                pauseBtn.classList.remove('btn-primary');
                pauseBtn.classList.add('btn-outline');

                if (testConfig.timeLimit > 0) {
                    startTimer();
                }
            } else {
                // Pause test
                testState.isPaused = true;
                pauseBtn.innerHTML = '<i class="fas fa-play"></i> Resume';
                pauseBtn.classList.remove('btn-outline');
                pauseBtn.classList.add('btn-primary');

                if (testState.timerInterval) {
                    clearInterval(testState.timerInterval);
                }
            }
        }

        function submitTest() {
            // Clear timer
            if (testState.timerInterval) {
                clearInterval(testState.timerInterval);
            }

            // Calculate score
            let correct = 0;
            const wrongAnswers = [];

            testState.questions.forEach((question, index) => {
                const userAnswer = testState.answers[index];
                if (userAnswer !== null && userAnswer === question.correct) {
                    correct++;
                } else if (userAnswer !== null) {
                    wrongAnswers.push({
                        question: question.question,
                        userAnswer: question.options[userAnswer],
                        correctAnswer: question.options[question.correct],
                        explanation: question.explanation,
                        tips: question.tips || []
                    });
                }
            });

            testState.score = correct;

            // Calculate time taken
            const endTime = new Date();
            const timeTaken = Math.floor((endTime - testState.startTime) / 1000); // in seconds
            const minutes = Math.floor(timeTaken / 60);
            const seconds = timeTaken % 60;

            // Store wrong answers for review
            testState.wrongAnswers = wrongAnswers;
            testState.totalTime = timeTaken;

            // Show results
            showResults(correct, testState.questions.length, `${minutes}:${seconds.toString().padStart(2, '0')}`);
        }

        function showResults(correct, total, timeTaken) {
            const score = Math.round((correct / total) * 100);

            // Update results modal
            document.getElementById('finalScore').textContent = score;
            document.getElementById('scoreText').textContent = correct;
            document.getElementById('totalText').textContent = total;
            document.getElementById('timeTakenText').textContent = timeTaken;
            document.getElementById('accuracyText').textContent = `${score}%`;

            // Determine strongest/weakest subjects (simplified)
            document.getElementById('strongSubject').textContent = testConfig.subjects[0];
            document.getElementById('weakSubject').textContent = testConfig.subjects[testConfig.subjects.length - 1];

            // Show results modal
            document.getElementById('testContainer').style.display = 'none';
            document.getElementById('resultsModal').style.display = 'flex';

            // Setup results modal buttons
            setupResultsModal();
        }

        function setupResultsModal() {
            const closeResultsBtn = document.getElementById('closeResultsBtn');
            const reviewWrongBtn = document.getElementById('reviewWrongBtn');
            const retakeTestBtn = document.getElementById('retakeTestBtn');

            closeResultsBtn.addEventListener('click', () => {
                document.getElementById('resultsModal').style.display = 'none';
                document.querySelector('.dashboard').style.display = 'grid';
            });

            reviewWrongBtn.addEventListener('click', () => {
                if (testState.wrongAnswers.length === 0) {
                    alert('No wrong answers to review!');
                    return;
                }
                document.getElementById('resultsModal').style.display = 'none';
                reviewWrongAnswers();
            });

            retakeTestBtn.addEventListener('click', () => {
                document.getElementById('resultsModal').style.display = 'none';
                openTestConfig();
            });

            // Click outside to close
            document.getElementById('resultsModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('resultsModal')) {
                    document.getElementById('resultsModal').style.display = 'none';
                    document.querySelector('.dashboard').style.display = 'grid';
                }
            });
        }

        function reviewWrongAnswers() {
            testState.isReviewing = true;
            testState.currentQuestion = 0;

            // Filter to only wrong answers
            const wrongQuestions = [];
            testState.questions.forEach((question, index) => {
                const userAnswer = testState.answers[index];
                if (userAnswer !== null && userAnswer !== question.correct) {
                    wrongQuestions.push({
                        ...question,
                        userAnswer: userAnswer
                    });
                }
            });

            if (wrongQuestions.length === 0) {
                alert('No wrong answers to review!');
                testState.isReviewing = false;
                document.querySelector('.dashboard').style.display = 'grid';
                return;
            }

            testState.reviewQuestions = wrongQuestions;
            showAIAssistant(wrongQuestions[0], 0, wrongQuestions.length);
        }

        function showAIAssistant(question, index, total) {
            // Update AI Assistant modal
            document.getElementById('aiQuestionText').textContent = question.question;
            document.getElementById('userAnswerText').textContent = question.options[question.userAnswer];
            document.getElementById('correctAnswerText').textContent = question.options[question.correct];
            document.getElementById('aiExplanationText').textContent = question.explanation;

            // Update tips
            const tipsList = document.getElementById('aiTipsList');
            tipsList.innerHTML = '';
            (question.tips || []).forEach(tip => {
                const li = document.createElement('li');
                li.textContent = tip;
                tipsList.appendChild(li);
            });

            // Update buttons
            const continueBtn = document.getElementById('continueBtn');
            const practiceBtn = document.getElementById('practiceMoreBtn');

            continueBtn.textContent = index === total - 1 ? 'Finish Review' : 'Next Question';

            continueBtn.onclick = () => {
                if (index < total - 1) {
                    showAIAssistant(testState.reviewQuestions[index + 1], index + 1, total);
                } else {
                    document.getElementById('aiAssistantModal').style.display = 'none';
                    testState.isReviewing = false;
                    document.querySelector('.dashboard').style.display = 'grid';
                }
            };

            practiceBtn.onclick = () => {
                alert('Loading practice questions...');
            };

            // Show AI Assistant modal
            document.getElementById('aiAssistantModal').style.display = 'flex';

            // Setup close button
            document.getElementById('closeAIModal').addEventListener('click', () => {
                document.getElementById('aiAssistantModal').style.display = 'none';
                testState.isReviewing = false;
                document.querySelector('.dashboard').style.display = 'grid';
            });

            // Click outside to close
            document.getElementById('aiAssistantModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('aiAssistantModal')) {
                    document.getElementById('aiAssistantModal').style.display = 'none';
                    testState.isReviewing = false;
                    document.querySelector('.dashboard').style.display = 'grid';
                }
            });
        }

        function endTest() {
            if (testState.timerInterval) {
                clearInterval(testState.timerInterval);
            }
            document.getElementById('testContainer').style.display = 'none';
            document.querySelector('.dashboard').style.display = 'grid';
        }
    </script>
</body>
</html>